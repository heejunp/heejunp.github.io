---
// 인트로 오버레이 컴포넌트
---

<div id="intro-overlay" class="intro-overlay">
	<div class="intro-content">
		<h1 class="intro-text">
			<span id="typed-text"></span>
			<span class="cursor">|</span>
		</h1>
		<p class="scroll-hint" id="scroll-hint">스크롤을 내려주세요 ↓</p>
	</div>
</div>

<style>
	.intro-overlay {
		position: fixed;
		top: 0;
		left: 0;
		width: 100%;
		height: 100vh;
		height: 100dvh; /* 동적 뷰포트 높이 지원 */
		background: #000000;
		display: flex;
		align-items: center;
		justify-content: center;
		z-index: 9999;
		transition: opacity 0.8s cubic-bezier(0.4, 0, 0.2, 1), visibility 0.8s cubic-bezier(0.4, 0, 0.2, 1);
		pointer-events: none;
		backdrop-filter: blur(0px);
	}

	/* 우주 배경 - 별들 */
	.intro-overlay::before {
		content: '';
		position: absolute;
		top: 0;
		left: 0;
		right: 0;
		bottom: 0;
		background-image: 
			radial-gradient(3px 3px at 10% 20%, #ffffff, transparent),
			radial-gradient(2px 2px at 20% 30%, #ffffff, transparent),
			radial-gradient(1px 1px at 30% 15%, #ffffff, transparent),
			radial-gradient(2px 2px at 40% 25%, #ffffff, transparent),
			radial-gradient(1px 1px at 50% 10%, #ffffff, transparent),
			radial-gradient(3px 3px at 60% 20%, #ffffff, transparent),
			radial-gradient(2px 2px at 70% 30%, #ffffff, transparent),
			radial-gradient(1px 1px at 80% 15%, #ffffff, transparent),
			radial-gradient(2px 2px at 90% 25%, #ffffff, transparent),
			radial-gradient(1px 1px at 15% 40%, #ffffff, transparent),
			radial-gradient(2px 2px at 25% 50%, #ffffff, transparent),
			radial-gradient(1px 1px at 35% 45%, #ffffff, transparent),
			radial-gradient(3px 3px at 45% 55%, #ffffff, transparent),
			radial-gradient(2px 2px at 55% 40%, #ffffff, transparent),
			radial-gradient(1px 1px at 65% 50%, #ffffff, transparent),
			radial-gradient(2px 2px at 75% 60%, #ffffff, transparent),
			radial-gradient(1px 1px at 85% 45%, #ffffff, transparent),
			radial-gradient(3px 3px at 95% 55%, #ffffff, transparent),
			radial-gradient(2px 2px at 5% 70%, #ffffff, transparent),
			radial-gradient(1px 1px at 15% 80%, #ffffff, transparent),
			radial-gradient(2px 2px at 25% 75%, #ffffff, transparent),
			radial-gradient(1px 1px at 35% 85%, #ffffff, transparent),
			radial-gradient(3px 3px at 45% 70%, #ffffff, transparent),
			radial-gradient(2px 2px at 55% 80%, #ffffff, transparent),
			radial-gradient(1px 1px at 65% 75%, #ffffff, transparent),
			radial-gradient(2px 2px at 75% 85%, #ffffff, transparent),
			radial-gradient(1px 1px at 85% 90%, #ffffff, transparent),
			radial-gradient(3px 3px at 95% 95%, #ffffff, transparent),
			radial-gradient(2px 2px at 12% 60%, #ffffff, transparent),
			radial-gradient(1px 1px at 22% 65%, #ffffff, transparent),
			radial-gradient(2px 2px at 32% 70%, #ffffff, transparent),
			radial-gradient(1px 1px at 42% 65%, #ffffff, transparent),
			radial-gradient(3px 3px at 52% 60%, #ffffff, transparent),
			radial-gradient(2px 2px at 62% 65%, #ffffff, transparent),
			radial-gradient(1px 1px at 72% 70%, #ffffff, transparent),
			radial-gradient(2px 2px at 82% 65%, #ffffff, transparent),
			radial-gradient(1px 1px at 92% 60%, #ffffff, transparent);
		background-size: 200% 200%;
		background-position: 0% 0%;
		opacity: 1;
		pointer-events: none;
		animation: starMove 50s linear infinite;
		z-index: 0;
	}

	/* 우주 배경 - 네뷸라 효과 */
	.intro-overlay::after {
		content: '';
		position: absolute;
		top: 0;
		left: 0;
		right: 0;
		bottom: 0;
		background: 
			radial-gradient(ellipse at 20% 30%, rgba(0, 255, 65, 0.1) 0%, transparent 50%),
			radial-gradient(ellipse at 80% 70%, rgba(255, 215, 0, 0.08) 0%, transparent 50%),
			radial-gradient(ellipse at 50% 50%, rgba(233, 69, 96, 0.06) 0%, transparent 50%);
		pointer-events: none;
		z-index: 0;
		animation: nebulaPulse 20s ease-in-out infinite alternate;
	}

	@keyframes starMove {
		0% { 
			background-position: 0% 0%;
		}
		100% { 
			background-position: 100% 100%;
		}
	}

	@keyframes nebulaPulse {
		0% {
			opacity: 0.5;
			transform: scale(1);
		}
		100% {
			opacity: 1;
			transform: scale(1.1);
		}
	}

	.intro-overlay.hidden {
		opacity: 0;
		visibility: hidden;
	}

	.intro-content {
		text-align: center;
	}

	.intro-text {
		font-family: 'Courier New', monospace;
		font-size: clamp(4rem, 10vw, 7rem);
		font-weight: 700;
		color: #00ff41;
		margin: 0;
		letter-spacing: 0.1em;
		line-height: 1.3;
		text-shadow: 
			4px 4px 0 #16213e,
			8px 8px 0 #1a1a2e,
			12px 12px 0 #0f3460;
		position: relative;
		z-index: 1;
		display: inline-block;
	}

	#typed-text {
		display: inline-block;
	}

	.cursor {
		display: inline-block;
		color: #00ff41;
		margin-left: 0.1em;
		animation: blink 1s infinite;
		font-weight: 300;
	}

	@keyframes blink {
		0%, 50% {
			opacity: 1;
		}
		51%, 100% {
			opacity: 0;
		}
	}

	.scroll-hint {
		font-family: 'Courier New', monospace;
		font-size: clamp(1rem, 2vw, 1.5rem);
		color: #ffd700;
		margin: 2rem 0 0 0;
		opacity: 0;
		text-shadow: 
			2px 2px 0 #16213e,
			4px 4px 0 #1a1a2e;
		letter-spacing: 0.05em;
		position: relative;
		z-index: 1;
		transition: opacity 0.3s ease;
	}

	.scroll-hint.visible {
		opacity: 1;
		animation: fadeInUp 0.8s ease-out forwards, bounce 2s ease-in-out infinite;
	}

	@keyframes fadeInUp {
		from {
			opacity: 0;
			transform: translateY(20px);
		}
		to {
			opacity: 1;
			transform: translateY(0);
		}
	}

	@keyframes bounce {
		0%, 100% {
			transform: translateY(0);
		}
		50% {
			transform: translateY(-10px);
		}
	}

	/* 모바일 최적화 */
	@media (max-width: 768px) {
		.intro-text {
			font-size: clamp(3rem, 15vw, 5rem);
		}
	}
</style>

<script>
	// 타이핑 효과 및 스크롤 감지
	document.addEventListener('DOMContentLoaded', () => {
		// skipIntro 쿼리 파라미터 확인
		const urlParams = new URLSearchParams(window.location.search);
		const skipIntro = urlParams.get('skipIntro') === 'true';
		
		// skipIntro가 true이면 오버레이를 즉시 숨기고 제거
		if (skipIntro) {
			const overlay = document.getElementById('intro-overlay');
			if (overlay) {
				overlay.remove();
				document.body.style.overflow = '';
			}
			return;
		}

		const overlay = document.getElementById('intro-overlay');
		if (!overlay) return;

		// 초기에는 body 스크롤 막기
		document.body.style.overflow = 'hidden';

		// 타이핑 효과
		const typedText = document.getElementById('typed-text');
		const scrollHint = document.getElementById('scroll-hint');
		const text = '안녕하세요';
		let index = 0;

		const typeText = () => {
			if (index < text.length) {
				typedText.textContent += text[index];
				index++;
				setTimeout(typeText, 150); // 각 글자마다 150ms 간격
			} else {
				// 타이핑 완료 후 안내 문구 표시
				if (scrollHint) {
					setTimeout(() => {
						scrollHint.classList.add('visible');
					}, 500);
				}
			}
		};

		// 약간의 딜레이 후 타이핑 시작
		setTimeout(typeText, 300);

		let scrolled = false;
		let touchStartY = 0;
		let touchStartTime = 0;

		const hideOverlay = () => {
			if (scrolled) return;
			scrolled = true;
			overlay.classList.add('hidden');
			
			// 스크롤 다시 활성화
			setTimeout(() => {
				document.body.style.overflow = '';
				if (overlay.parentNode) {
					overlay.remove();
				}
			}, 800);
		};

		// 스크롤 이벤트 리스너
		let ticking = false;
		const handleScroll = () => {
			if (!scrolled && window.scrollY > 30) {
				hideOverlay();
			}
		};

		window.addEventListener('scroll', () => {
			if (!ticking) {
				window.requestAnimationFrame(() => {
					handleScroll();
					ticking = false;
				});
				ticking = true;
			}
		}, { passive: true });

		// 터치 이벤트 감지 (모바일 스와이프)
		window.addEventListener('touchstart', (e) => {
			touchStartY = e.touches[0].clientY;
			touchStartTime = Date.now();
		}, { passive: true });

		window.addEventListener('touchmove', (e) => {
			if (scrolled) return;
			const touchY = e.touches[0].clientY;
			const deltaY = touchStartY - touchY;
			const deltaTime = Date.now() - touchStartTime;
			
			// 위로 스와이프 감지 (속도와 거리 고려)
			if (deltaY > 50 && deltaTime < 500) {
				hideOverlay();
			}
		}, { passive: true });

		// 마우스 휠 이벤트 (데스크톱)
		window.addEventListener('wheel', (e) => {
			if (!scrolled && e.deltaY > 0) {
				hideOverlay();
			}
		}, { passive: true });
	});
</script>
